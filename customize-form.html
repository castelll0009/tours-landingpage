<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario Bootstrap con Validación y Barra de Progreso</title>
    <!-- Agrega los enlaces a los archivos de Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>
<body>

<div class="container mt-5">
    <!-- Título personalizado -->
    <h2>Customizing</h2>
    
    <!-- Barra de Progreso -->
    <div class="progress mt-2">
        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
    </div>
    <h3 id="progress-title" class="text-warning">Progreso: 0%</h3>

    <form id="miFormulario" class="needs-validation" novalidate>
        <div class="form-group">
            <label for="nombre">Nombre:</label>
            <input type="text" class="form-control" id="nombre" required>
            <div class="valid-feedback">Correcto</div>
            <div class="invalid-feedback">Por favor, ingresa tu nombre.</div>
        </div>
        <div class="form-group">
            <label for="email">Correo electrónico:</label>
            <input type="email" class="form-control" id="email" required>
            <div class="valid-feedback">Correcto</div>
            <div class="invalid-feedback">Por favor, ingresa un correo electrónico válido.</div>
        </div>
        <div class="form-group">
            <label for="telefono">Teléfono:</label>
            <div class="input-group">
                <div class="input-group-prepend">
                    <select class="custom-select" id="indicativo">
                        <option value="+51">+51</option>
                        <option value="+1">+1</option>
                        <option value="+57">+57</option>
                        <!-- Add more country codes as needed -->
                    </select>
                </div>
                <input type="tel" class="form-control" id="telefono" pattern="[0-9]{10}" required>
            </div>
            <div class="valid-feedback">Correcto</div>
            <div class="invalid-feedback">Por favor, ingresa un número de teléfono válido (10 dígitos).</div>
        </div>
        <div class="form-group">
            <label for="descripcion">Descripción:</label>
            <textarea class="form-control" id="descripcion" rows="4" required></textarea>
            <div class="valid-feedback">Correcto</div>
            <div class="invalid-feedback">Por favor, ingresa una descripción.</div>
        </div>
        <button type="submit" class="btn btn-primary">Enviar</button>
    </form>
</div>

<script>
    // Agrega la validación de Bootstrap
    (function () {
        'use strict';

        var formulario = document.getElementById('miFormulario');
        var progressBar = document.getElementById('progress-bar');
        var progressTitle = document.getElementById('progress-title');

        formulario.addEventListener('input', function () {
            var nombre = document.getElementById('nombre').value;
            var email = document.getElementById('email').value;
            var telefono = document.getElementById('telefono').value;
            var descripcion = document.getElementById('descripcion').value;

            // Calcular el progreso basado en la cantidad de campos completados
            var camposCompletados = 0;
            if (nombre) camposCompletados++;
            if (email) camposCompletados++;
            if (telefono) camposCompletados++;
            if (descripcion) camposCompletados++;

            var progreso = (camposCompletados / 4) * 100; // 4 es el número total de campos

            // Actualizar la barra de progreso
            progressBar.style.width = progreso + '%';
            progressBar.setAttribute('aria-valuenow', progreso);

            // Cambiar el color de fondo de la barra de progreso según el porcentaje
            var color;
            if (progreso <= 25) {
                color = '#FFA500'; // Amarillo oscuro
            } else if (progreso <= 50) {
                color = '#FFD700'; // Amarillo
            } else if (progreso <= 75) {
                color = '#FF8C00'; // Naranja oscuro
            } else {
                color = '#32CD32'; // Verde
                progressTitle.textContent = 'Formulario listo'; // Cambiar el título al completar
            }
            progressBar.style.backgroundColor = color;

            // Actualizar el título de progreso
            progressTitle.textContent = 'Progreso: ' + progreso + '%';
        });

        formulario.addEventListener('submit', function (event) {
            if (!formulario.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }

            formulario.classList.add('was-validated');

            // Construct WhatsApp and Gmail links
            var indicativo = document.getElementById('indicativo').value;
            var telefono = document.getElementById('telefono').value;
            var nombre = document.getElementById('nombre').value;
            var descripcion = document.getElementById('descripcion').value;
            var email = document.getElementById('email').value;

            var whatsappLink = 'https://wa.me/' + indicativo + telefono + '?text=Nombre: ' + nombre + '%0ACorreo: ' + email + '%0ADescripción: ' + descripcion;
            var gmailLink = 'mailto:castelll0009@gmail.com?subject=Consulta&body=Nombre: ' + nombre + '%0ACorreo: ' + email + '%0ADescripción: ' + descripcion;

            // Open WhatsApp link in a new tab
            window.open(whatsappLink, '_blank');

            // Create a hidden link for Gmail and trigger a click event
            var gmailHiddenLink = document.createElement('a');
            gmailHiddenLink.href = gmailLink;
            gmailHiddenLink.style.display = 'none';
            document.body.appendChild(gmailHiddenLink);
            gmailHiddenLink.click();
        }, false);
    })();
</script>

</body>
</html>
